window.espni=window.espni||{};espni.ESPNiVodPlayer=function($){var api={};var video=api.video={};var AUTOPLAY_SUPPORT=false;api.classNames={wrapper:"espni-vid-wrapper",loader:"espni-vid-loader",playbutton:"video-play-button",placeholder:"espni-vid-placeholder",videoLength:"video-length",videoStarted:"video-started"};api.ajaxLoader="https://i.imgci.com/espncricinfo/gfx/loading.gif";api.ajaxLoaderWidth=16;api.ajaxLoaderHeight=11;api.videoPlayerId="video-player";try{if(isMobile.phone===false&&isMobile.tablet===false){AUTOPLAY_SUPPORT=true}}catch(e){}api.init=function(){var autoPlayVideos;if(typeof videojs!=="undefinded"){autoPlayVideos=$(".vod_autoplay");$(document).on("click",".espni-vid-wrapper .video-play-button,.espni-vid-wrapper .espni-vid-thumb",callEvent);if(AUTOPLAY_SUPPORT&&autoPlayVideos.size()>0){autoPlayVideos.eq(0).trigger("click")}}};function callEvent(e){e.preventDefault();var $videoElem=$(this),$videoWrapper=$videoElem.closest("."+api.classNames.wrapper),thumbnail=$videoWrapper.find("."+api.classNames.placeholder).attr("data-mezzaninepathimage"),clipId=$videoWrapper.find("."+api.classNames.placeholder).attr("data-id"),preroll=$videoWrapper.find("."+api.classNames.placeholder).data("preroll");if(typeof preroll==="undefined"){preroll=true}video.play($videoElem,{id:clipId,thumbnail:thumbnail,autostart:true,preroll:preroll});if(typeof espn.video.isPlaying=="undefined"||!espn.video.isPlaying){espn.video.play()}}video.playerContainer=null;video.isPlaying=false;video.pause=function(){espn.video.pause()};video.unmount=function(){try{espn.video.remove();video.playerContainer=null;video.isPlaying=false;$("."+api.classNames.videoStarted).removeClass(api.classNames.videoStarted)}catch(e){}};video.play=function($ele,options){var clipId=options.id;var videoPlayer='<div id="'+api.videoPlayerId+'"></div>';if(typeof videojs==="undefinded"||typeof clipId==="undefinded"){return}video.unmount();var $videoWrapper=$ele.closest("."+api.classNames.wrapper);var vid_container_height;var loader=$('<img class="'+api.classNames.loader+'" src="'+api.ajaxLoader+'"/>').css({position:"absolute",left:$videoWrapper.width()/2-api.ajaxLoaderWidth/2,bottom:$videoWrapper.height()/2-api.ajaxLoaderHeight/2});var playtype=$videoWrapper.find("."+api.classNames.placeholder).attr("data-autostart");var isAutoplay=playtype=="true";var siteSection=options.siteSection||"espn:cricinfo:frontpage";var poster=options.thumbnailURL||"";var endcard=options.endCard||false;var preroll=options.preroll||false;var postroll=options.postroll||false;var omnitureSuiteId=options.omnitureSuiteId||window.s_omni&&s_omni.account||window.s_account;var embedOptions={cerebroId:clipId,cms:"cric",targetReplaceId:api.videoPlayerId,siteSection:siteSection,advertising:{siteSectionId:siteSection},analytics:{adobeDCR:{APP_MEASUREMENT:{RSID:omnitureSuiteId}}},autoplay:isAutoplay,preroll:preroll,postroll:postroll,api:{getRelated:function(id,options,callback){if(typeof id==="string"&&!id.match("espn")){id="espn:"+id}var clips=[],url="https://www.espn.com/videohub/player/getRelatedFeed",country=options&&options.country&&options.country.substr(options.country.indexOf("_")+1),queryParams={mediaId:id,country:country,siteSection:"espncricinfo",excludeLatest:true};return this.request.get(url).query(queryParams).accept("xml").end(function(error,res){var item,asseturl,items,i,len;if(error){return callback(error,null)}items=res.xhr.responseXML.getElementsByTagName("item");for(i=0,len=items.length;i<len;i++){item=items[i];asseturl=item.querySelector("asseturl").textContent||":";clips.push({caption:item.querySelector("caption").textContent,duration:item.getAttribute("duration"),headline:item.querySelector("headline").textContent,id:asseturl.split(":")[1],poster:item.querySelector("thumbnailurl").textContent,source:asseturl.split(":")[0],web:item.querySelector("hostedAtURL").textContent,mediaId:asseturl})}return callback(null,clips)})}}};if(!isAutoplay){embedOptions.advertising.beforeAdManager=function(options){embedOptions.startType=false;return embedOptions}}video.playerContainer=$videoWrapper;video.isPlaying=true;$videoWrapper.addClass(api.classNames.videoStarted);$videoWrapper.append(videoPlayer);espn.video.embed(embedOptions)};return api}(jQuery);jQuery(function(){espni.ESPNiVodPlayer.init()});
